<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>For You ü§ç</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0b141a;
            --header-bg: #202c33;
            --wa-green: #005c4b;
            --wa-incoming: #202c33;
            --accent: #00a884;
            --text-main: #e9edef;
            --input-bg: #2a3942;
            --meta-color: #8696a0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        html, body {
            height: 100%; width: 100%;
            background-color: var(--bg-dark);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        /* FLYING HEARTS - BACKGROUND LAYER */
        .heart {
            position: fixed; 
            bottom: -100px;
            pointer-events: none; 
            /* Floating BEHIND the white box (105) */
            z-index: 102; 
            animation: moveUp linear forwards;
            font-family: 'Dancing Script', cursive;
            font-weight: bold;
            opacity: 0.8; 
        }
        @keyframes moveUp {
            from { transform: translateY(0); opacity: 0.8; }
            to { transform: translateY(-120dvh); opacity: 0; }
        }

        #app {
            display: flex; flex-direction: column;
            height: 100dvh; width: 100%;
            position: relative; z-index: 10;
        }

        .header {
            height: 60px; background: var(--header-bg);
            display: flex; align-items: center; padding: 0 15px;
            flex-shrink: 0; color: white; border-bottom: 1px solid rgba(255,255,255,0.05);
            z-index: 20;
        }

        .dp {
            width: 45px; height: 45px; border-radius: 50%;
            background: #6a7175 url('dp.jpg') center/cover;
            margin-right: 12px; transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .dp.has-status {
            border: 2.5px solid var(--accent);
            padding: 2px; background-clip: content-box; cursor: pointer;
        }

        #chatArea {
            flex: 1; overflow-y: auto; padding: 10px 15px;
            background: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
            background-blend-mode: overlay; 
            background-color: rgba(11, 20, 26, 0.9);
            display: flex; flex-direction: column;
            position: relative;
        }

        .msg {
            max-width: 85%; padding: 8px 10px 6px 12px;
            font-size: 15.5px; line-height: 1.4; border-radius: 8px;
            color: white; margin: 6px 0; display: flex; flex-direction: column;
            box-shadow: 0 1px 1px rgba(0,0,0,0.2); animation: pop 0.2s ease-out;
            position: relative; z-index: 10;
        }
        @keyframes pop { from { transform: scale(0.9); opacity: 0; } }

        .left { align-self: flex-end; background: var(--wa-green); border-top-right-radius: 0; }
        .right { align-self: flex-start; background: var(--wa-incoming); border-top-left-radius: 0; }

        .meta {
            align-self: flex-end; display: flex; align-items: center;
            font-size: 11px; color: var(--meta-color); margin-top: 2px; margin-left: 20px;
        }
        .ticks { color: #53bdeb; margin-left: 3px; font-size: 14px; }

        .input-bar {
            background: var(--header-bg); padding: 10px 12px;
            display: flex; align-items: center; gap: 8px; flex-shrink: 0;
            padding-bottom: calc(10px + env(safe-area-inset-bottom));
            z-index: 20;
        }

        #userInput {
            flex: 1; background: var(--input-bg); padding: 12px 16px;
            border-radius: 24px; color: white; outline: none; font-size: 16px;
        }

        .full-screen {
            position: fixed; inset: 0; 
            background: var(--bg-dark);
            z-index: 100; display: flex; flex-direction: column;
            justify-content: center; align-items: center; padding: 20px;
        }

        .btn {
            background: #ff4d6d; color: white; border: none;
            padding: 15px 35px; border-radius: 50px; font-weight: 600; margin: 10px;
            cursor: pointer; transition: transform 0.2s;
            z-index: 110;
        }

        #letterContainer {
            width: 95%; height: 75dvh; background: #fff5f7;
            border-radius: 20px; position: relative; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            z-index: 105; 
        }

        #letterBox {
            width: 100%; height: 100%; padding: 25px;
            color: #d63384; font-family: 'Dancing Script', cursive;
            font-size: 24px; overflow-y: auto; border-radius: 20px; text-align: left;
        }

        .close-btn {
            position: absolute; top: -15px; right: -15px;
            width: 40px; height: 40px; background: #ff4d6d;
            color: white; border-radius: 50%; display: flex;
            justify-content: center; align-items: center; border: 3px solid #fff; cursor: pointer;
            z-index: 115;
        }

        #statusViewer {
            position: fixed; inset: 0; background: black;
            z-index: 250; display: none; flex-direction: column;
            justify-content: center; align-items: center;
        }
        .status-header {
            position: absolute; top: 10px; width: 100%; padding: 10px;
            display: flex; flex-direction: column; gap: 8px; z-index: 215;
        }
        .progress-bars { display: flex; gap: 5px; width: 100%; }
        .bar-bg { flex: 1; height: 3px; background: rgba(255,255,255,0.3); border-radius: 2px; overflow: hidden; }
        .bar-fill { height: 100%; background: white; width: 0%; transition: width 0.1s linear; }
        .bar-fill.completed { width: 100% !important; }
        
        .status-nav-container { position: absolute; inset: 0; display: flex; z-index: 210; }
        .nav-zone { flex: 1; height: 100%; }
        .status-content { width: 100%; max-height: 85vh; object-fit: contain; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="app">
    <div class="header">
        <div class="dp" id="profilePic" onclick="startStatus()"></div>
        <div>
            <div style="font-weight: 500; font-size: 17px;">Kedi üíö</div>
            <div id="statusLabel" style="font-size: 12px; color: var(--meta-color);">online</div>
        </div>
    </div>

    <div id="chatArea"></div>

    <div class="input-bar">
        <div id="userInput" contenteditable="true" onfocus="if(this.innerText=='Type a message')this.innerText=''">Type a message</div>
        <button class="send-btn" style="background:none; border:none;" onclick="handleSend()">
            <svg viewBox="0 0 24 24" width="30" height="30" fill="var(--accent)"><path d="M1.101 21.757L23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"></path></svg>
        </button>
    </div>

    <div id="stageEnvelope" class="full-screen hidden">
        <div style="font-size: 100px; cursor: pointer; z-index: 110;" onclick="showValentine()">üíå</div>
        <p style="color: white; margin-top: 20px; font-family: 'Dancing Script'; font-size: 26px; z-index: 110;">Touch the heart</p>
    </div>

    <div id="stageValentine" class="full-screen hidden">
        <h2 style="color: white; margin-bottom: 30px; font-family: 'Dancing Script'; font-size: 36px; z-index: 110;">Will you be my Valentine? ü§ç</h2>
        <div style="display: flex; gap: 15px; position: relative; width: 100%; justify-content: center; z-index: 110;">
            <button class="btn" id="yesBtn" onclick="showWho()">Yes</button>
            <button class="btn" id="noBtn" style="background: #6a7175;">No</button>
        </div>
    </div>

    <div id="stageWho" class="full-screen hidden">
        <h2 style="color: white; margin-bottom: 20px; font-family: 'Dancing Script'; font-size: 32px; z-index: 110;">Yaarupa neengaa...</h2>
        <button class="btn" onclick="showLetter()">Kedi</button>
        <button class="btn" onclick="accessDenied()">Varthuuu</button>
    </div>

    <div id="stageLetter" class="full-screen hidden">
        <div id="letterContainer">
            <div class="close-btn" onclick="finishLetter()">‚úï</div>
            <div id="letterBox"></div>
        </div>
    </div>
</div>

<div id="statusViewer">
    <div class="status-header">
        <div class="progress-bars" id="progressBars"></div>
        <div style="color: white; font-size: 14px; margin-left: 5px; font-weight: 500;">Kedi üíö</div>
    </div>
    <div class="status-nav-container">
        <div class="nav-zone" onclick="prevStatus()"></div>
        <div class="nav-zone" onclick="nextStatusManual()"></div>
    </div>
    <div class="close-btn" style="top: 45px; right: 20px; z-index: 220;" onclick="closeStatus()">‚úï</div>
    <img id="statusImg" class="status-content" src="">
</div>

<script>
    const chatArea = document.getElementById('chatArea');
    const userInput = document.getElementById('userInput');
    const statusLabel = document.getElementById('statusLabel');
    const profilePic = document.getElementById('profilePic');
    const popSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3');

    const myStatuses = [
        "https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=800", 
        "https://images.unsplash.com/photo-1494774157365-9e04c6720e47?w=800"
    ];

    const script = ["Hey sexxy darling ...üòò", "inaiku valentine's day ah?", "Happy valentine's day üíñ", "So I made something for you", "love.var"];
    let step = 0;
    let heartInterval;

    function getTime() { return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }); }

    async function kediType() {
        if (step >= script.length) return;
        statusLabel.innerText = "typing...";
        await new Promise(r => setTimeout(r, 1500));
        const isLink = script[step] === "love.var";
        const bubble = document.createElement('div');
        bubble.className = "msg right";
        bubble.innerHTML = `<span>${isLink ? `<b style="color:#53bdeb; text-decoration:underline; cursor:pointer;" onclick="startSurprise()">${script[step]}</b>` : script[step]}</span><div class="meta">${getTime()}</div>`;
        chatArea.appendChild(bubble);
        popSound.play().catch(()=>{});
        chatArea.scrollTop = chatArea.scrollHeight;
        statusLabel.innerText = "online";
    }

    function handleSend() {
        const text = userInput.innerText.trim();
        if (!text || text === "Type a message") return;
        userInput.innerText = "";
        const bubble = document.createElement('div');
        bubble.className = "msg left";
        bubble.innerHTML = `<span>${text}</span><div class="meta">${getTime()} <span class="ticks">‚úì‚úì</span></div>`;
        chatArea.appendChild(bubble);
        chatArea.scrollTop = chatArea.scrollHeight;
        step++;
        setTimeout(kediType, 800);
    }

    function startSurprise() { 
        document.getElementById('stageEnvelope').classList.remove('hidden'); 
        if(heartInterval) clearInterval(heartInterval);
        heartInterval = setInterval(spawnHeart, 400); 
    }

    function spawnHeart() {
        const h = document.createElement('div'); h.className = 'heart';
        const items = ["‚ù§Ô∏è", "üíñ", "üíù", "ü§ç", "üíï","kedi","papu","kutty","sexxy darling"];
        h.innerText = items[Math.floor(Math.random() * items.length)];
        
        h.style.color = "#a01a58"; 
        if(h.innerText.length < 3) h.style.color = "#700a0a"; 
        
        h.style.left = Math.random() * 100 + "vw"; 
        h.style.fontSize = Math.random() * 10 + 20 + "px";
        h.style.animationDuration = Math.random() * 2 + 5 + "s";
        document.body.appendChild(h); 
        setTimeout(() => h.remove(), 7000);
    }

    function showValentine() { 
        document.getElementById('stageEnvelope').classList.add('hidden'); 
        document.getElementById('stageValentine').classList.remove('hidden'); 
    }

    function showWho() { 
        document.getElementById('stageValentine').classList.add('hidden'); 
        document.getElementById('stageWho').classList.remove('hidden'); 
    }
    
    function accessDenied() {
        alert("Sorry ungaluku ulla idam ila getout");
        clearInterval(heartInterval);
        // Hide all screens and return to chat
        document.getElementById('stageWho').classList.add('hidden');
        document.getElementById('stageEnvelope').classList.add('hidden');
        document.getElementById('stageValentine').classList.add('hidden');
        
        setTimeout(async () => {
            statusLabel.innerText = "typing..."; 
            await new Promise(r => setTimeout(r, 2000));
            const bubble = document.createElement('div');
            bubble.className = "msg right";
            bubble.innerHTML = `<span>Ozunga option choose panu d venna mavalae üôÑ</span><div class="meta">${getTime()}</div>`;
            chatArea.appendChild(bubble);
            popSound.play().catch(()=>{});
            chatArea.scrollTop = chatArea.scrollHeight;
            statusLabel.innerText = "online";
        }, 800);
    }

    const noBtn = document.getElementById('noBtn');
    const yesBtn = document.getElementById('yesBtn');
    let scale = 1;
    noBtn.onmouseover = noBtn.ontouchstart = (e) => {
        if(e.type === 'touchstart') e.preventDefault();
        scale += 0.4;
        yesBtn.style.transform = `scale(${scale})`;
        noBtn.style.position = 'absolute';
        noBtn.style.top = Math.random() * 70 + 10 + '%';
        noBtn.style.left = Math.random() * 70 + 10 + '%';
    };

    function showLetter() {
        document.getElementById('stageWho').classList.add('hidden');
        document.getElementById('stageLetter').classList.remove('hidden');
        const box = document.getElementById('letterBox');
        const text = "We started our journey with affection‚Ä¶ and even today I still wonder how you slowly became a part of me ü§ç\n\nEvery day felt new with you. Our love kept growing ‚Äî like a full moon that never fades and never returns to darkness üåô\n\nThat one week when we matched outfits without planning‚Ä¶ that was our golden time. Every day had a feeling, every moment had meaning ‚ú®\n\nAs days passed, we changed‚Ä¶ we grew‚Ä¶ and quietly our love grew with us üå±\n\nThe silly romantic tests we attended, and the late nights we spent talking ‚Äî they are locked safely inside the secret vault of my heart üîê\n\nThe day I came to meet you in Chennai was planned long before‚Ä¶ but every minute there still felt magical üèôÔ∏è\n\nThat private beach where we took pictures‚Ä¶ the waves, the wind, and you ‚Äî it still feels unreal üåä\n\nYou preparing yourself for my sister's marriage meant more to me than I ever said. I didn't ruin anything intentionally‚Ä¶ I only wanted to always be honest with you ü§ç\n\nNo matter what happened between us, one thing never changed ‚Äî I always wanted you to be happy\n\nMaybe love is not always about staying‚Ä¶ sometimes it's about remembering gently and wishing silently üåô\n\nI don't know where life will take us next, but a part of my heart will always smile when it thinks of you\n\nSo today, I just wish you peace, warmth, and a life that treats you kindly\n\nHappy Valentine's Day ‚ù§Ô∏è";
        let i = 0;
        function type() { if (i < text.length) { box.innerHTML += text.charAt(i) === "\n" ? "<br>" : text.charAt(i); i++; box.scrollTop = box.scrollHeight; setTimeout(type, 35); } }
        type();
    }

    function finishLetter() {
        clearInterval(heartInterval);
        document.getElementById('stageLetter').classList.add('hidden');
        profilePic.classList.add('has-status');
        setTimeout(async () => {
            statusLabel.innerText = "typing..."; await new Promise(r => setTimeout(r, 2000));
            const bubble = document.createElement('div');
            bubble.className = "msg right";
            bubble.innerHTML = `<span>status paarunga thangooo üòç</span><div class="meta">${getTime()}</div>`;
            chatArea.appendChild(bubble);
            popSound.play().catch(()=>{});
            chatArea.scrollTop = chatArea.scrollHeight;
            statusLabel.innerText = "online";
        }, 1000);
    }

    let currentStatusIdx = 0;
    let statusInterval;
    let startTime;
    const STATUS_DURATION = 30000;

    function startStatus() {
        if (!profilePic.classList.contains('has-status')) return;
        document.getElementById('statusViewer').style.display = 'flex';
        setupProgressBars();
        showStatus(0);
    }

    function setupProgressBars() {
        const container = document.getElementById('progressBars');
        container.innerHTML = '';
        myStatuses.forEach(() => {
            const bg = document.createElement('div');
            bg.className = 'bar-bg';
            bg.innerHTML = '<div class="bar-fill"></div>';
            container.appendChild(bg);
        });
    }

    function showStatus(index) {
        if (index >= myStatuses.length) { closeStatus(); return; }
        currentStatusIdx = index;
        const img = document.getElementById('statusImg');
        const fills = document.querySelectorAll('.bar-fill');
        img.src = myStatuses[currentStatusIdx];

        fills.forEach((fill, i) => {
            fill.style.width = '0%';
            fill.classList.remove('completed');
            if (i < currentStatusIdx) fill.classList.add('completed');
        });

        startTime = Date.now();
        clearInterval(statusInterval);
        statusInterval = setInterval(() => {
            let elapsed = Date.now() - startTime;
            let progress = (elapsed / STATUS_DURATION) * 100;
            fills[currentStatusIdx].style.width = Math.min(progress, 100) + '%';
            if (elapsed >= STATUS_DURATION) nextStatus();
        }, 50);
    }

    function nextStatus() {
        currentStatusIdx++;
        if (currentStatusIdx < myStatuses.length) showStatus(currentStatusIdx);
        else closeStatus();
    }

    function nextStatusManual() { clearInterval(statusInterval); nextStatus(); }
    function prevStatus() {
        clearInterval(statusInterval);
        if (currentStatusIdx > 0) showStatus(currentStatusIdx - 1);
        else showStatus(0);
    }

    function closeStatus() {
        document.getElementById('statusViewer').style.display = 'none';
        clearInterval(statusInterval);
    }

    window.onload = kediType;
</script>
</body>
</html>